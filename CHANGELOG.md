# 更新日志

本项目所有值得注意的更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)。

## [v0.0.15] (2025-11-15)

### 新增

- **Context 扩展工具**
  - 新增 `context` 包，提供 `WithoutCancel` 函数，用于创建忽略父 context 取消信号的新 context。
  - 支持继承父 context 的值传递功能，但阻断取消和超时信号。
  - 兼容 Go 1.21 之前版本，提供与标准库 `context.WithoutCancel` 相同的功能。
  - 提供详细的原理说明文档和完整单元测试。

- **导入语句规范检查工具**
  - 新增 `go/imp` 包，实现 Go 文件导入语句的规范性检查。
  - 支持导入分组检查（内置包、第三方包、fsyyft-go 包、项目内包）。
  - 支持导入排序检查，确保每组内按字母顺序排列。
  - 支持别名规范检查，确保 fsyyft-go 包使用 kit 前缀，项目内包使用 app 前缀，别名只包含小写字母和数字。
  - 提供 `Check` 函数用于批量检查指定目录下的所有 Go 文件。

### 变更

- **CI 配置优化**
  - 分离测试和代码检查任务，提高 CI 执行效率。
  - 新增环境变量配置，统一管理 golangci-lint 版本（v1.64.8）和 Go 版本（1.25）。
  - 优化测试矩阵，支持多版本 Go（1.25、1.24、1.23）并发测试。
  - 优化 golangci-lint 安装方式，使用固定版本以避免版本兼容问题。
  - 更新 CI 工作流文件名引用（go.yml → ci.yml）。

- **文档系统**
  - README 新增 codecov 徽章，展示代码覆盖率。
  - README 更新 CI 工作流状态徽章链接。
  - 新增 context 包详细文档，包含原理说明、使用示例和最佳实践。

- **代码规范**
  - 统一导入别名风格，修正 `kratos/config` 包中的别名格式（kratosConfig → kratosconfig，kratosEncoding → kratosencoding）。
  - 修正 `net/http` 包中的导入别名（kiglog → kitlog）。
  - 修正 `net/message` 包中的导入别名（cockroachdbErrors → cockroachdberrors）。

### 修复

- **注释规范**
  - 完善 `go/imp` 包中所有函数、类型和方法的中文注释，符合项目注释规范。
  - 优化函数体内注释，详细说明业务逻辑和关键步骤。

## [v0.0.14] (2025-09-07)

### 新增

- **CI 配置**
  - 新增 `.gitattributes` 文件，配置 Git LFS 管理大文件（如 PDF、图片、压缩包、二进制库等），并补充相关说明。

### 变更

- **环境与兼容性**
  - 升级 Go 语言版本至 1.25，提升性能与新特性支持。
  - `runtime/goroutine` 新增 `runtime_go1.25.go`，适配 Go 1.25 版本的 goid 偏移量和相关结构体。
  - 优化 `goid_offset.go`，完善各版本偏移量注释和兼容性处理。

## [v0.0.13] (2025-05-17)

### 新增

- **通用类型转换工具**
  - 新增 `convert` 包，提供丰富的类型转换函数，支持任意类型与基础类型、切片、Map、结构体间的安全转换，兼容 gconv，支持带错误和无错误两套 API，适用于数据解析、配置加载、接口适配等场景。
  - 提供详细文档和完整单元测试，接口设计现代，易于扩展。
- **汉字转拼音工具**
  - 新增 `text/pinyin` 包，基于 go-pinyin 实现，支持多音字、拼音风格定制、分隔符自定义，适用于文本处理、搜索、排序等场景。
  - 提供详细文档和单元测试，接口简洁灵活。
- **分布式唯一 ID 生成器**
  - 新增 `algorithms/snowflake` 包，实现经典 Snowflake 算法，支持多节点高并发、趋势递增 64 位 ID、多种编码格式（十进制、二进制、Base32、Base36、Base58、Base64），适用于数据库主键、分布式事务、消息队列等场景。
  - 支持多种解析与互逆、JSON 序列化、并发安全，文档与单元测试覆盖完善。

## [v0.0.12] (2025-05-17)

### 新增

- **自定义消息协议与连接封装**
  - 新增 `net/message` 包，实现自定义消息协议的网络连接、消息工厂、心跳机制、消息拆包封包、类型定义等，支持 TCP 消息收发、心跳消息、单字符串消息等，具备详细文档与完整单元测试。
  - 新增 `example/net/message` 示例，包含服务端、客户端及构建脚本，演示自定义消息协议的实际应用。

### 变更

- 优化 `example/kratos/config` 示例导入路径。
- 优化 Makefile，增加 net message 示例的构建和运行步骤。

### 修复

- 修复 `database/redis` NewRedis 函数中的冗余 Close 调用，避免资源重复释放。

## [v0.0.11] (2025-05-01)

### 新增

- **布隆过滤器**:
  - 新增 `container/bloom` 包，支持高效布隆过滤器，具备分组、可插拔存储（内存/Redis）、误判率灵活配置、并发安全等特性。
  - 提供详细文档和完整单元测试，接口与实现分离，支持 Option 配置。
- **SHA 哈希工具**:
  - 新增 `crypto/sha` 包，简化 SHA256/SHA1 哈希计算接口，支持错误处理和无错误版本。
  - 100% 单元测试覆盖，性能基准测试完善。
- **Redis 客户端**:
  - 新增 `database/redis` 包，封装 go-redis v9，统一接口，支持原生命令、管道、事务、Lua 脚本、发布订阅、基础 KV 操作等。
  - 提供 Option 配置、类型适配、丰富的扩展接口和详细文档。
- **HTTP 客户端工具**:
  - 新增 `net/http` 子包，提供功能丰富的 HTTP 客户端，支持 GET/POST/HEAD/表单/JSON、超时、代理、钩子、慢请求日志、trace、全局方法等。
  - 支持灵活的 Option 配置、钩子扩展、慢日志与链路追踪，接口设计现代，文档与单元测试覆盖完善。
- **重试机制工具**:
  - 新增 `runtime/retry` 包，提供通用的重试机制，支持带/不带 context 的函数重试，内置指数退避与抖动（Jitter），可灵活配置最小/最大等待、增长因子等参数。
  - 支持取消与超时控制，API 简洁，适用于网络请求、数据库操作等易失败场景，单元测试覆盖率高。

### 变更

- **配置解析增强**:
  - kratos/config 解析器新增对 `.env` 后缀的支持，配置项以 `.env` 结尾时可自动从环境变量读取实际值，解析后存储到去除后缀的键中，便于敏感信息和多环境配置的灵活管理。
- **文档与注释优化**:
  - 所有核心包 README 结构清晰，内容详实，去除 AI 生成相关说明，提升专业性。

### 修复

## [v0.0.10] (2025-04-19)

### 新增

- **运行时工具**:
  - 实现协程池功能，支持任务提交和资源管理
  - 集成 Prometheus 监控指标
  - 提供完整的单元测试覆盖
  - 添加详细的文档说明

- **数据库支持**:
  - 添加 GORM 日志适配器
  - 提供 GORM 使用示例
  - 优化 MySQL 钩子配置逻辑
  - 完善数据库示例文档

### 变更

- **日志系统**:
  - 优化日志记录操作，使用异步处理提升性能

- **时间工具**:
  - 更新 carbon 库版本
  - 调整时间函数返回类型

- **构建系统**:
  - 升级 golang.org/x/net 依赖到 v0.39.0 版本
  - 更新 golang.org/x 相关包

### 修复

- **数据库组件**:
  - 优化事务示例代码
  - 改进 MySQL 钩子配置逻辑

## [v0.0.9] (2025-04-12)

### 新增

- **数据库支持**:
  - 实现 MySQL 数据库基础功能支持
  - 添加数据库 SQL 驱动钩子机制
  - 实现错误日志和慢查询日志功能
  - 提供完整的 MySQL 使用示例
  - 添加数据库操作构建脚本

## [v0.0.8] (2025-04-05)

### 新增

- **HTTP 服务器**:
  - 优化与 Gin 框架的路由集成
  - 改进服务器路由处理
  - 完善集成测试用例

### 变更

- **代码结构**:
  - 重构 cache 模块实现和接口
  - 优化 log 模块代码结构
  - 改进 crypto 模块错误处理
  - 统一代码风格和注释规范

- **文档系统**:
  - 为所有核心包添加详细文档
  - 统一文档格式和风格
  - 完善示例代码和使用说明
  - 添加包级别文档（doc.go）

- **构建系统**:
  - 优化构建脚本和工具链
  - 改进错误处理机制
  - 统一构建流程

### 移除

- **构建工具**:
  - 移除 Windows 平台构建脚本（.bat）
  - 统一使用 Shell 脚本

## [v0.0.7] (2025-03-15)

### 新增

- **加密工具**:
  - 实现 RSA 加密解密功能，支持标准加密和解密操作
  - 新增 MD5 哈希计算功能，支持字符串和文件哈希
  - 实现 AES-GCM 加密解密功能，提供安全的对称加密
  - 添加一次性密码（OTP）工具包，支持动态密码生成和验证

- **数学工具**:
  - 新增 rand 包，实现随机数生成功能
  - 支持随机汉字字符生成
  - 完整的单元测试覆盖

- **构建工具**:
  - 新增构建上下文管理功能
  - 添加版本信息管理功能
  - 提供示例实现

- **字节工具**:
  - 新增安全随机字节生成功能

### 变更

- **工程化**:
  - 优化构建系统
  - 重构调试模式检测逻辑
  - 完善文档和示例

## [v0.0.6] (2025-03-08)

### 新增

- **加密工具**:
  - 实现 DES 加密算法
  - 支持 CBC 模式和 PKCS7 填充
  - 添加中文字符串加密支持
  - 完整的单元测试覆盖

- **认证中间件**:
  - 添加基本认证中间件
  - 添加请求验证中间件
  - 完善与 Gin 框架的集成测试

- **配置功能**:
  - 添加配置解码器
  - 支持 base64 解码功能
  - 支持 DES 解密功能
  - 优化配置加载示例

- **时间工具**:
  - 新增时间处理包
  - 引入 carbon 库支持

- **运行时工具**:
  - 添加 Runner 接口定义

### 变更

- **工程化**:
  - 优化代码结构和格式
  - 统一代码注释风格
  - 重构示例代码结构
  - 更新构建脚本

## [v0.0.5] (2025-02-22)

### 新增

- **缓存系统**: 实现统一的缓存抽象层
  - 支持多种缓存后端（默认使用 ristretto）
  - 提供类型安全的泛型接口
  - 支持 TTL（生存时间）设置
  - 提供全局缓存实例
  - 完整的单元测试覆盖
  - 详细的使用文档和示例

### 变更

- **工程化**:
  - 更新项目依赖
  - 优化构建配置

## [v0.0.4] (2025-02-22)

### 新增

- **日志系统**:
  - 增加日志示例构建脚本（支持 Windows 和 Unix）
  - 完善文档和使用说明

### 变更

- **日志系统**:
  - 重构日志输出格式，默认改为 JSON 格式
  - 优化日志格式化逻辑
  - 更新文档和版权信息

### 修复

- **运行时工具**:
  - 进一步优化 arm64 和 Windows 平台的兼容性

## [v0.0.3] (2025-02-22)

### 新增

- **运行时工具**:
  - 新增 goroutine 包使用示例
  - 增加示例代码构建脚本（支持 Windows 和 Unix）

### 变更

- **工程化**:
  - 优化持续集成工作流配置
  - 统一修正源码版权信息
  - 更新构建脚本

### 修复

- **运行时工具**:
  - 修复 arm64 架构下的编译错误
  - 修复 Windows 平台下的编译错误

## [v0.0.2] (2025-02-22)

### 新增

- **日志系统**:
  - 增加日志文件滚动功能
  - 完善示例代码和使用说明

### 变更

- **日志系统**:
  - 重构 Logger 初始化方法，引入函数式配置选项模式
  - 重构 LogrusLogger 初始化方法，优化配置流程
  - 更新并完善所有包的文档说明

- **文档**:
  - 完善项目整体文档结构
  - 新增 FAQ 和贡献指南
  - 更新测试包使用文档

## [v0.0.1] (2025-02-22)

### 新增

- **工程化**:
  - 添加 GitHub Actions CI 工作流配置
  - 新增基础类库 Makefile 支持
  - 优化持续集成工作流程

### 修复

- **运行时工具**: 修复 goroutine ID 偏移量计算错误

## [v0.0.0] (2025-02-22)

### 新增

- **日志系统**: 实现统一的日志抽象层
  - 支持多种日志后端（logrus、标准日志）
  - 提供全局日志实例
  - 完整的单元测试覆盖
  - 详细的使用文档和示例

- **运行时工具**: 实现 goroutine ID 获取功能
  - 支持多个 Go 版本（1.5-1.23）
  - 支持多种系统架构（amd64、arm64）
  - 提供快速和慢速两种实现方式
  - 完整的单元测试和文档

- **测试工具**: 新增测试辅助包
  - 提供统一的日志输出功能
  - 简化测试用例编写

- **工程化**:
  - 初始化项目结构
  - 配置 Go 模块依赖管理
  - 添加 .gitignore 配置