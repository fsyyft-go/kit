# Build.sh 模板生成器

## 角色（Role）
你是一位专业的 DevOps 工程师和 Shell 脚本专家，精通 Bash 脚本编写和 Go 项目构建流程。你的任务是分析现有的构建脚本，提取共同模式，并创建一个标准化、模块化且可扩展的构建脚本模板。

## 背景（Context）
在 Go 项目开发中，构建脚本（build.sh）是自动化编译、测试和部署过程的关键组件。然而，不同子项目的构建脚本往往存在不一致性，缺乏标准化的结构和最佳实践。这导致了维护困难、功能重复和潜在的错误。

项目中的 example 目录下有多个子项目，每个都包含自己的 build.sh 文件，这些文件有共同的基础结构，但也有特定的功能扩展。我们需要从这些现有脚本中提取共同模式和最佳实践，创建一个标准化的模板。

## 目标（Objective）
1. 分析 example 目录下所有 build.sh 文件的结构和功能
2. 识别共同的模式、功能和最佳实践
3. 设计一个模块化、可扩展的 build.sh 模板
4. 确保模板包含所有必要的基础功能，同时允许项目特定的扩展
5. 生成详细的文档，解释模板的使用方法和自定义选项

## 要求（Requirements）
1. 模板必须包含以下基础功能：
   - 错误处理和退出机制
   - 路径和目录设置
   - 基本的构建命令
   - 输出格式化和日志记录
   - 运行构建后的程序

2. 模板应支持以下可选功能模块：
   - 版本信息管理（从 Git 获取版本号、提交哈希等）
   - 跨平台构建支持（多操作系统、多架构）
   - 构建参数配置（通过命令行参数或配置文件）
   - 日志文件处理和显示
   - 测试运行和验证

3. 模板应具有良好的：
   - 注释和文档
   - 模块化结构
   - 错误处理机制
   - 可配置性和可扩展性

## 约束（Constraints）
1. 模板必须使用 Bash 语法，并兼容主流的 Unix/Linux 环境
2. 模板应避免使用过于复杂或不常见的 Bash 特性，以确保兼容性
3. 模板应遵循 Shell 脚本的最佳实践和安全标准
4. 模板应该是自包含的，不依赖于外部工具（除了基本的 Unix 工具和 Go 工具链）
5. 模板的设计应考虑不同项目的特定需求，提供清晰的扩展点

## 输出格式（Output Format）
请生成以下文件：

1. `build.sh` - 主模板文件，包含所有基础功能和可选模块
   - 文件应包含详细的注释，解释每个部分的功能和用法
   - 文件应使用模块化结构，清晰分隔不同功能
   - 文件应包含示例配置和使用说明

2. `README.md` - 模板使用文档
   - 文件应包含模板的概述和目的
   - 文件应详细解释如何使用和自定义模板
   - 文件应包含常见用例和示例
   - 文件应包含故障排除指南

## 示例（Examples）
以下是一个简化的示例，展示了模板的基本结构：

```bash
#!/bin/bash

# 设置错误时退出
set -e

# ===== 基础配置 =====
# 脚本所在目录
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
# 项目根目录
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../" && pwd)"
# 源文件路径
SOURCE_FILE="$SCRIPT_DIR/main.go"
# 输出目录
OUTPUT_DIR="$PROJECT_ROOT/bin/myproject"
# 输出文件名
OUTPUT_NAME="myapp"

# ===== 可选配置 =====
# 是否启用版本信息
ENABLE_VERSION_INFO=true
# 是否启用跨平台构建
ENABLE_CROSS_PLATFORM=false
# 是否显示日志文件
SHOW_LOGS=false

# ===== 函数定义 =====

# 版本信息处理函数
get_version_info() {
    # 实现版本信息获取逻辑
}

# 构建函数
build() {
    # 实现构建逻辑
}

# 主函数
main() {
    # 实现主要流程
}

# 执行主函数
main
```

## 评估标准（Evaluation Criteria）
生成的模板将根据以下标准进行评估：

1. 完整性：是否包含所有必要的基础功能和可选模块
2. 模块化：是否具有清晰的模块化结构，便于理解和自定义
3. 可扩展性：是否提供了清晰的扩展点，便于项目特定的定制
4. 文档质量：是否包含详细的注释和使用说明
5. 兼容性：是否兼容主流的 Unix/Linux 环境
6. 最佳实践：是否遵循 Shell 脚本的最佳实践和安全标准
7. 实用性：是否易于使用和适应不同项目的需求 